$ ansible-playbook -v revprxy.yaml
Using /etc/ansible/ansible.cfg as config file

PLAY [nginx] **************************************************************************************************************************

TASK [ensure nginx is at the latest version] ******************************************************************************************
 [WARNING]: Could not find aptitude. Using apt-get instead

changed: [nginx-tmp] => {"ansible_facts": {"discovered_interpreter_python": "/usr/bin/python3"}, "cache_update_time": 1650608925, "cache_updated": true, "changed": true, "stderr": "", "stderr_lines": [], "stdout": "Reading package lists...\nBuilding dependency tree...\nReading state information...\nThe following additional packages will be installed:\n  libnginx-mod-http-image-filter libnginx-mod-http-xslt-filter\n  libnginx-mod-mail libnginx-mod-stream nginx-common nginx-core\nSuggested packages:\n  fcgiwrap nginx-doc ssl-cert\nThe following NEW packages will be installed:\n  libnginx-mod-http-image-filter libnginx-mod-http-xslt-filter\n  libnginx-mod-mail libnginx-mod-stream nginx nginx-common nginx-core\n0 upgraded, 7 newly installed, 0 to remove and 2 not upgraded.\nPreconfiguring packages ...\nNeed to get 0 B/605 kB of archives.\nAfter this operation, 2134 kB of additional disk space will be used.\nSelecting previously unselected package nginx-common.\r\n(Reading database ... \r(Reading database ... 5%\r(Reading database ... 10%\r(Reading database ... 15%\r(Reading database ... 20%\r(Reading database ... 25%\r(Reading database ... 30%\r(Reading database ... 35%\r(Reading database ... 40%\r(Reading database ... 45%\r(Reading database ... 50%\r(Reading database ... 55%\r(Reading database ... 60%\r(Reading database ... 65%\r(Reading database ... 70%\r(Reading database ... 75%\r(Reading database ... 80%\r(Reading database ... 85%\r(Reading database ... 90%\r(Reading database ... 95%\r(Reading database ... 100%\r(Reading database ... 60951 files and directories currently installed.)\r\nPreparing to unpack .../0-nginx-common_1.18.0-0ubuntu1.3_all.deb ...\r\nUnpacking nginx-common (1.18.0-0ubuntu1.3) ...\r\nSelecting previously unselected package libnginx-mod-http-image-filter.\r\nPreparing to unpack .../1-libnginx-mod-http-image-filter_1.18.0-0ubuntu1.3_amd64.deb ...\r\nUnpacking libnginx-mod-http-image-filter (1.18.0-0ubuntu1.3) ...\r\nSelecting previously unselected package libnginx-mod-http-xslt-filter.\r\nPreparing to unpack .../2-libnginx-mod-http-xslt-filter_1.18.0-0ubuntu1.3_amd64.deb ...\r\nUnpacking libnginx-mod-http-xslt-filter (1.18.0-0ubuntu1.3) ...\r\nSelecting previously unselected package libnginx-mod-mail.\r\nPreparing to unpack .../3-libnginx-mod-mail_1.18.0-0ubuntu1.3_amd64.deb ...\r\nUnpacking libnginx-mod-mail (1.18.0-0ubuntu1.3) ...\r\nSelecting previously unselected package libnginx-mod-stream.\r\nPreparing to unpack .../4-libnginx-mod-stream_1.18.0-0ubuntu1.3_amd64.deb ...\r\nUnpacking libnginx-mod-stream (1.18.0-0ubuntu1.3) ...\r\nSelecting previously unselected package nginx-core.\r\nPreparing to unpack .../5-nginx-core_1.18.0-0ubuntu1.3_amd64.deb ...\r\nUnpacking nginx-core (1.18.0-0ubuntu1.3) ...\r\nSelecting previously unselected package nginx.\r\nPreparing to unpack .../6-nginx_1.18.0-0ubuntu1.3_all.deb ...\r\nUnpacking nginx (1.18.0-0ubuntu1.3) ...\r\nSetting up nginx-common (1.18.0-0ubuntu1.3) ...\r\nCreated symlink /etc/systemd/system/multi-user.target.wants/nginx.service -> /lib/systemd/system/nginx.service.\r\nSetting up libnginx-mod-http-xslt-filter (1.18.0-0ubuntu1.3) ...\r\nSetting up libnginx-mod-mail (1.18.0-0ubuntu1.3) ...\r\nSetting up libnginx-mod-http-image-filter (1.18.0-0ubuntu1.3) ...\r\nSetting up libnginx-mod-stream (1.18.0-0ubuntu1.3) ...\r\nSetting up nginx-core (1.18.0-0ubuntu1.3) ...\r\nSetting up nginx (1.18.0-0ubuntu1.3) ...\r\nProcessing triggers for systemd (245.4-4ubuntu3.16) ...\r\nProcessing triggers for man-db (2.9.1-1) ...\r\nProcessing triggers for ufw (0.36-6ubuntu1) ...\r\n", "stdout_lines": ["Reading package lists...", "Building dependency tree...", "Reading state information...", "The following additional packages will be installed:", "  libnginx-mod-http-image-filter libnginx-mod-http-xslt-filter", "  libnginx-mod-mail libnginx-mod-stream nginx-common nginx-core", "Suggested packages:", "  fcgiwrap nginx-doc ssl-cert", "The following NEW packages will be installed:", "  libnginx-mod-http-image-filter libnginx-mod-http-xslt-filter", "  libnginx-mod-mail libnginx-mod-stream nginx nginx-common nginx-core", "0 upgraded, 7 newly installed, 0 to remove and 2 not upgraded.", "Preconfiguring packages ...", "Need to get 0 B/605 kB of archives.", "After this operation, 2134 kB of additional disk space will be used.", "Selecting previously unselected package nginx-common.", "(Reading database ... ", "(Reading database ... 5%", "(Reading database ... 10%", "(Reading database ... 15%", "(Reading database ... 20%", "(Reading database ... 25%", "(Reading database ... 30%", "(Reading database ... 35%", "(Reading database ... 40%", "(Reading database ... 45%", "(Reading database ... 50%", "(Reading database ... 55%", "(Reading database ... 60%", "(Reading database ... 65%", "(Reading database ... 70%", "(Reading database ... 75%", "(Reading database ... 80%", "(Reading database ... 85%", "(Reading database ... 90%", "(Reading database ... 95%", "(Reading database ... 100%", "(Reading database ... 60951 files and directories currently installed.)", "Preparing to unpack .../0-nginx-common_1.18.0-0ubuntu1.3_all.deb ...", "Unpacking nginx-common (1.18.0-0ubuntu1.3) ...", "Selecting previously unselected package libnginx-mod-http-image-filter.", "Preparing to unpack .../1-libnginx-mod-http-image-filter_1.18.0-0ubuntu1.3_amd64.deb ...", "Unpacking libnginx-mod-http-image-filter (1.18.0-0ubuntu1.3) ...", "Selecting previously unselected package libnginx-mod-http-xslt-filter.", "Preparing to unpack .../2-libnginx-mod-http-xslt-filter_1.18.0-0ubuntu1.3_amd64.deb ...", "Unpacking libnginx-mod-http-xslt-filter (1.18.0-0ubuntu1.3) ...", "Selecting previously unselected package libnginx-mod-mail.", "Preparing to unpack .../3-libnginx-mod-mail_1.18.0-0ubuntu1.3_amd64.deb ...", "Unpacking libnginx-mod-mail (1.18.0-0ubuntu1.3) ...", "Selecting previously unselected package libnginx-mod-stream.", "Preparing to unpack .../4-libnginx-mod-stream_1.18.0-0ubuntu1.3_amd64.deb ...", "Unpacking libnginx-mod-stream (1.18.0-0ubuntu1.3) ...", "Selecting previously unselected package nginx-core.", "Preparing to unpack .../5-nginx-core_1.18.0-0ubuntu1.3_amd64.deb ...", "Unpacking nginx-core (1.18.0-0ubuntu1.3) ...", "Selecting previously unselected package nginx.", "Preparing to unpack .../6-nginx_1.18.0-0ubuntu1.3_all.deb ...", "Unpacking nginx (1.18.0-0ubuntu1.3) ...", "Setting up nginx-common (1.18.0-0ubuntu1.3) ...", "Created symlink /etc/systemd/system/multi-user.target.wants/nginx.service -> /lib/systemd/system/nginx.service.", "Setting up libnginx-mod-http-xslt-filter (1.18.0-0ubuntu1.3) ...", "Setting up libnginx-mod-mail (1.18.0-0ubuntu1.3) ...", "Setting up libnginx-mod-http-image-filter (1.18.0-0ubuntu1.3) ...", "Setting up libnginx-mod-stream (1.18.0-0ubuntu1.3) ...", "Setting up nginx-core (1.18.0-0ubuntu1.3) ...", "Setting up nginx (1.18.0-0ubuntu1.3) ...", "Processing triggers for systemd (245.4-4ubuntu3.16) ...", "Processing triggers for man-db (2.9.1-1) ...", "Processing triggers for ufw (0.36-6ubuntu1) ..."]}

TASK [start nginx] ********************************************************************************************************************
ok: [nginx-tmp] => {"changed": false, "name": "nginx", "state": "started", "status": {"ActiveEnterTimestamp": "Fri 2022-04-22 06:28:49 UTC", "ActiveEnterTimestampMonotonic": "16684685069", "ActiveExitTimestampMonotonic": "0", "ActiveState": "active", "After": "network.target system.slice systemd-journald.socket sysinit.target basic.target", "AllowIsolate": "no", "AllowedCPUs": "", "AllowedMemoryNodes": "", "AmbientCapabilities": "", "AssertResult": "yes", "AssertTimestamp": "Fri 2022-04-22 06:28:49 UTC", "AssertTimestampMonotonic": "16684659106", "Before": "shutdown.target multi-user.target", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "CPUAccounting": "no", "CPUAffinity": "", "CPUAffinityFromNUMA": "no", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "[not set]", "CPUUsageNSec": "[not set]", "CPUWeight": "[not set]", "CacheDirectoryMode": "0755", "CanIsolate": "no", "CanReload": "yes", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read 0x26 0x27 0x28", "CleanResult": "success", "CollectMode": "inactive", "ConditionResult": "yes", "ConditionTimestamp": "Fri 2022-04-22 06:28:49 UTC", "ConditionTimestampMonotonic": "16684659105", "ConfigurationDirectoryMode": "0755", "Conflicts": "shutdown.target", "ControlGroup": "/system.slice/nginx.service", "ControlPID": "0", "DefaultDependencies": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "Delegate": "no", "Description": "A high performance web server and a reverse proxy server", "DevicePolicy": "auto", "Documentation": "man:nginx(8)", "DynamicUser": "no", "EffectiveCPUs": "", "EffectiveMemoryNodes": "", "ExecMainCode": "0", "ExecMainExitTimestampMonotonic": "0", "ExecMainPID": "60575", "ExecMainStartTimestamp": "Fri 2022-04-22 06:28:49 UTC", "ExecMainStartTimestampMonotonic": "16684685032", "ExecMainStatus": "0", "ExecReload": "{ path=/usr/sbin/nginx ; argv[]=/usr/sbin/nginx -g daemon on; master_process on; -s reload ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecReloadEx": "{ path=/usr/sbin/nginx ; argv[]=/usr/sbin/nginx -g daemon on; master_process on; -s reload ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStart": "{ path=/usr/sbin/nginx ; argv[]=/usr/sbin/nginx -g daemon on; master_process on; ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStartEx": "{ path=/usr/sbin/nginx ; argv[]=/usr/sbin/nginx -g daemon on; master_process on; ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStartPre": "{ path=/usr/sbin/nginx ; argv[]=/usr/sbin/nginx -t -q -g daemon on; master_process on; ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStartPreEx": "{ path=/usr/sbin/nginx ; argv[]=/usr/sbin/nginx -t -q -g daemon on; master_process on; ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStop": "{ path=/sbin/start-stop-daemon ; argv[]=/sbin/start-stop-daemon --quiet --stop --retry QUIT/5 --pidfile /run/nginx.pid ; ignore_errors=yes ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStopEx": "{ path=/sbin/start-stop-daemon ; argv[]=/sbin/start-stop-daemon --quiet --stop --retry QUIT/5 --pidfile /run/nginx.pid ; flags=ignore-failure ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FinalKillSignal": "9", "FragmentPath": "/lib/systemd/system/nginx.service", "GID": "[not set]", "GuessMainPID": "yes", "IOAccounting": "no", "IOReadBytes": "18446744073709551615", "IOReadOperations": "18446744073709551615", "IOSchedulingClass": "0", "IOSchedulingPriority": "0", "IOWeight": "[not set]", "IOWriteBytes": "18446744073709551615", "IOWriteOperations": "18446744073709551615", "IPAccounting": "no", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "Id": "nginx.service", "IgnoreOnIsolate": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestampMonotonic": "0", "InactiveExitTimestamp": "Fri 2022-04-22 06:28:49 UTC", "InactiveExitTimestampMonotonic": "16684661760", "InvocationID": "3c27af3db4d54703ad5d4d0ed1fc1760", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "JobTimeoutUSec": "infinity", "KeyringMode": "private", "KillMode": "mixed", "KillSignal": "15", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitCORE": "infinity", "LimitCORESoft": "0", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitMEMLOCK": "65536", "LimitMEMLOCKSoft": "65536", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitNOFILE": "524288", "LimitNOFILESoft": "1024", "LimitNPROC": "15656", "LimitNPROCSoft": "15656", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "LimitSIGPENDING": "15656", "LimitSIGPENDINGSoft": "15656", "LimitSTACK": "infinity", "LimitSTACKSoft": "8388608", "LoadState": "loaded", "LockPersonality": "no", "LogLevelMax": "-1", "LogRateLimitBurst": "0", "LogRateLimitIntervalUSec": "0", "LogsDirectoryMode": "0755", "MainPID": "60575", "MemoryAccounting": "yes", "MemoryCurrent": "2265088", "MemoryDenyWriteExecute": "no", "MemoryHigh": "infinity", "MemoryLimit": "infinity", "MemoryLow": "0", "MemoryMax": "infinity", "MemoryMin": "0", "MemorySwapMax": "infinity", "MountAPIVFS": "no", "MountFlags": "", "NFileDescriptorStore": "0", "NRestarts": "0", "NUMAMask": "", "NUMAPolicy": "n/a", "Names": "nginx.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "none", "OOMPolicy": "stop", "OOMScoreAdjust": "0", "OnFailureJobMode": "replace", "PIDFile": "/run/nginx.pid", "Perpetual": "no", "PrivateDevices": "no", "PrivateMounts": "no", "PrivateNetwork": "no", "PrivateTmp": "no", "PrivateUsers": "no", "ProtectControlGroups": "no", "ProtectHome": "no", "ProtectHostname": "no", "ProtectKernelLogs": "no", "ProtectKernelModules": "no", "ProtectKernelTunables": "no", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "ReloadResult": "success", "RemainAfterExit": "no", "RemoveIPC": "no", "Requires": "system.slice sysinit.target", "Restart": "no", "RestartKillSignal": "15", "RestartUSec": "100ms", "RestrictNamespaces": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "Result": "success", "RootDirectoryStartOnly": "no", "RuntimeDirectoryMode": "0755", "RuntimeDirectoryPreserve": "no", "RuntimeMaxUSec": "infinity", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "Slice": "system.slice", "StandardError": "inherit", "StandardInput": "null", "StandardInputData": "", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "5", "StartLimitIntervalUSec": "10s", "StartupBlockIOWeight": "[not set]", "StartupCPUShares": "[not set]", "StartupCPUWeight": "[not set]", "StartupIOWeight": "[not set]", "StateChangeTimestamp": "Fri 2022-04-22 06:28:49 UTC", "StateChangeTimestampMonotonic": "16684685069", "StateDirectoryMode": "0755", "StatusErrno": "0", "StopWhenUnneeded": "no", "SubState": "running", "SuccessAction": "none", "SyslogFacility": "3", "SyslogLevel": "6", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "0", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "yes", "TasksCurrent": "3", "TasksMax": "4696", "TimeoutAbortUSec": "5s", "TimeoutCleanUSec": "infinity", "TimeoutStartUSec": "1min 30s", "TimeoutStopUSec": "5s", "TimerSlackNSec": "50000", "Transient": "no", "Type": "forking", "UID": "[not set]", "UMask": "0022", "UnitFilePreset": "enabled", "UnitFileState": "enabled", "UtmpMode": "init", "WantedBy": "multi-user.target", "WatchdogSignal": "6", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "0"}}

TASK [create CA key] ******************************************************************************************************************
ok: [nginx-tmp] => {"changed": false, "filename": "/root/CA_key.pem", "fingerprint": {"blake2b": "79:06:69:2d:76:2e:75:09:91:f4:55:9f:ec:79:ed:68:32:ca:f5:56:02:96:a0:41:a4:92:d5:32:a8:57:b5:36:f7:e6:29:74:8d:71:87:bd:45:0c:7e:94:23:cd:94:dc:17:1c:04:4b:69:dd:51:fc:94:ed:27:87:f4:63:11:82", "blake2s": "cc:6a:04:eb:a5:36:fa:04:3b:bf:2c:9c:1e:fa:d6:8f:7c:94:10:fc:74:8d:30:d3:60:38:cd:93:30:93:66:ca", "md5": "8d:22:2c:45:70:e3:5d:56:33:c0:76:7c:33:d7:f7:1d", "sha1": "36:09:2d:41:33:1c:ab:22:db:47:fb:6a:c9:f9:ec:ca:51:13:88:9c", "sha224": "86:37:6a:20:eb:c3:9f:e4:36:e5:4e:ad:96:ba:43:56:ba:81:e2:0d:10:bf:ba:0a:95:a1:09:c1", "sha256": "50:a7:f7:de:bc:ac:95:ba:54:e5:c4:89:49:fa:18:55:03:ea:b0:12:b4:89:7d:d4:d8:23:c3:10:82:2c:62:7b", "sha384": "96:da:e2:c8:4d:61:14:07:04:66:35:44:61:26:a0:87:4e:d1:0f:47:7e:48:79:a5:de:5e:68:76:42:d7:5c:57:9e:14:c0:8d:15:7b:0b:76:b8:24:b1:b5:01:71:1f:a3", "sha3_224": "9a:a8:6b:0c:43:00:21:67:0b:dd:b5:48:c3:5c:e3:a9:d0:0b:6a:3e:b5:5a:d2:da:64:a3:b3:e9", "sha3_256": "bf:74:b5:c0:3d:f4:51:e8:1e:a4:00:13:7f:39:bf:ed:db:45:63:3f:71:ed:65:f2:e2:44:d9:58:d4:b7:da:35", "sha3_384": "75:21:38:59:81:38:7e:a1:33:01:3b:05:31:51:ff:3f:2e:b4:47:b0:7f:b8:f2:53:8b:44:f0:2b:1f:f0:b1:27:4d:bf:2e:b4:bc:5e:a3:96:d5:a3:bc:3c:1b:93:38:0a", "sha3_512": "f8:45:2c:96:b5:83:c5:62:a8:f7:23:ca:d1:60:88:8f:49:09:72:6d:87:c5:86:bf:11:f0:96:37:ad:02:cd:70:eb:4e:02:46:ec:b3:d7:60:7d:5f:fc:cd:17:a5:d7:a9:d7:45:e9:26:76:13:03:3e:f6:31:bb:75:ed:3e:7f:3c", "sha512": "69:65:18:03:1e:d5:e0:40:2c:d1:5a:07:de:72:b4:14:e6:77:3e:25:b2:ee:94:d7:0c:ea:8e:28:88:96:35:f9:a0:e8:28:59:89:3c:9c:c2:04:ae:73:83:de:74:55:ab:da:a3:89:35:1a:fa:61:79:43:ed:b2:54:7e:f9:28:3c", "shake_128": "7f:06:d0:b6:04:16:68:4a:bb:33:e3:d8:96:94:8f:68:5f:c2:88:95:79:8b:9a:be:6e:16:34:77:06:df:03:c2", "shake_256": "c3:0d:de:44:5f:c1:21:f8:ef:1f:5a:22:d1:6e:39:fa:b4:66:d9:d7:37:77:04:4e:57:d7:0e:38:a4:0f:65:c4"}, "size": 4096, "type": "RSA"}

TASK [create the CA CSR] **************************************************************************************************************
ok: [nginx-tmp] => {"basicConstraints": null, "changed": false, "extendedKeyUsage": null, "filename": "/root/CA.csr", "keyUsage": null, "ocspMustStaple": false, "privatekey": "/root/CA_key.pem", "subject": [["CN", "34.148.84.22"]], "subjectAltName": ["DNS:34.148.84.22"]}

TASK [sign the CA CSR] ****************************************************************************************************************
ok: [nginx-tmp] => {"changed": false, "csr": "/root/CA.csr", "filename": "/root/CA.crt", "notAfter": "20320417063510Z", "notBefore": "20220420063510Z", "privatekey": "/root/CA_key.pem", "serial_number": 309355567937592538017490900526510855028498930493}

TASK [create Nginx CSR signing key] ***************************************************************************************************
ok: [nginx-tmp] => {"changed": false, "filename": "/root/app_key.pem", "fingerprint": {"blake2b": "27:7b:4d:4b:d2:5b:51:8e:8c:05:e0:1b:8f:4a:86:d1:f0:00:e7:e2:35:90:02:ba:f9:d7:89:de:da:34:f5:97:d3:51:9f:03:27:54:7d:29:7a:55:21:24:ac:42:e7:f2:a2:b1:ca:95:eb:e7:a8:1c:34:2f:2c:7a:74:61:a2:bb", "blake2s": "6d:b1:41:48:fb:99:97:20:8b:be:04:e4:49:74:56:9e:9a:0a:25:c6:8c:fc:f5:99:08:d4:1a:73:4d:aa:f7:69", "md5": "53:27:7f:ee:84:fb:44:47:be:d4:39:f0:0a:de:1c:15", "sha1": "96:12:f1:4f:79:69:19:7c:18:e0:27:ca:c9:ae:f0:0e:a3:db:2c:1a", "sha224": "d7:22:47:53:6d:54:ec:48:72:2b:4b:f1:d1:b9:da:94:b1:86:75:28:39:8e:1f:98:20:97:7c:03", "sha256": "cd:31:a8:b3:38:24:00:bd:03:e5:fe:67:6b:4a:9b:8e:53:1e:bd:57:17:69:04:45:4f:91:f6:50:3d:74:1d:db", "sha384": "42:98:e2:41:6a:0c:5f:6d:83:1a:bd:36:85:63:07:bf:24:bb:da:24:a9:24:eb:fc:fc:61:ba:26:90:82:d5:75:f6:c5:90:42:fc:79:a5:c9:1e:e1:86:45:76:a6:02:b0", "sha3_224": "45:0f:b6:8b:6a:90:b9:b6:8f:ec:82:27:88:3d:97:8e:62:d5:dd:ee:58:bb:44:09:9e:26:8b:58", "sha3_256": "2b:13:a8:cb:01:93:90:bf:d7:e9:bb:de:b2:04:e1:a8:d5:5a:30:d8:8e:48:3b:6e:fd:c4:e6:3d:24:e9:e1:06", "sha3_384": "d8:37:a7:80:39:25:47:17:39:1a:4f:0f:26:42:b0:ae:59:e6:49:c6:44:99:eb:c5:0a:d3:ac:84:24:0c:c3:ff:92:77:e5:f5:f2:76:52:27:bb:32:a1:8f:0a:3d:89:40", "sha3_512": "9b:f8:59:af:db:d8:c6:da:bc:d0:f1:d2:2e:f4:c2:ab:a5:70:6b:f5:2d:5d:1b:4e:7b:2a:9e:10:75:e9:34:e2:85:4c:6a:ed:e8:83:6d:9a:7f:6f:df:fe:7e:50:77:ba:a3:84:8f:89:dd:bf:19:b1:9b:78:5d:c8:0e:32:d2:4f", "sha512": "a3:32:2d:ea:f4:26:08:e6:b5:d7:cf:6d:43:f4:85:35:f9:55:d5:48:44:24:0b:9e:b1:8a:93:14:45:21:87:e3:f7:b8:50:c2:f0:98:a2:ef:ed:ec:ab:ef:8a:60:45:17:b7:2b:b2:61:df:16:1e:b7:7a:e2:e6:90:00:5e:12:1f", "shake_128": "93:e6:46:43:fe:61:d7:6c:d8:b4:3c:6e:cc:49:4b:4b:a7:6a:92:d4:09:f2:7d:92:a9:19:f8:4e:68:40:b6:e3", "shake_256": "08:0c:5c:5d:a6:1e:22:c9:1d:9d:15:36:c5:2b:b3:9d:5e:1a:58:87:4d:73:fb:9a:81:2e:2d:08:93:95:9d:31"}, "size": 4096, "type": "RSA"}

TASK [create the CSR for Nginx host] **************************************************************************************************
ok: [nginx-tmp] => {"basicConstraints": null, "changed": false, "extendedKeyUsage": null, "filename": "/root/app.csr", "keyUsage": null, "ocspMustStaple": false, "privatekey": "/root/app_key.pem", "subject": [], "subjectAltName": ["IP:34.148.84.22", "DNS:mydom.in"]}

TASK [sign the CSR for the Nginx host] ************************************************************************************************
ok: [nginx-tmp] => {"ca_cert": "/root/CA.crt", "ca_privatekey": "/root/CA_key.pem", "changed": false, "csr": "/root/app.csr", "filename": "/root/app.crt", "notAfter": "20320417074848Z", "notBefore": "20220420074848Z", "privatekey": null, "serial_number": 359884269970841170423740873332363133342817863386}

TASK [Copy Configuration Snippet Pointing to the SSL Key and Certificate] *************************************************************
changed: [nginx-tmp] => {"changed": true, "checksum": "2ca8041d1aa560a87e8a4995bf46d98798e8635d", "dest": "/etc/nginx/snippets/self-signed.conf", "gid": 0, "group": "root", "md5sum": "542b79c43431bdacb10368b7225a6bad", "mode": "0644", "owner": "root", "size": 91, "src": "/home/nginx/.ansible/tmp/ansible-tmp-1650609216.1446662-149141653288658/source", "state": "file", "uid": 0}

TASK [Creating a Configuration Snippet with Strong Encryption Settings] ***************************************************************
changed: [nginx-tmp] => {"changed": true, "checksum": "f15e4de9cd6a3fa8e5a794a539fb0a415c2d6618", "dest": "/etc/nginx/snippets/ssl-params.conf", "gid": 0, "group": "root", "md5sum": "edff11b9256930d29ac0323965d1a385", "mode": "0644", "owner": "root", "size": 799, "src": "/home/nginx/.ansible/tmp/ansible-tmp-1650609281.018401-209452380335164/source", "state": "file", "uid": 0}

TASK [Creating a file with content] ***************************************************************************************************
changed: [nginx-tmp] => {"changed": true, "checksum": "a2a3baf2f84ee416e630edd08a84008183679c94", "dest": "/etc/nginx/sites-available/nexus", "gid": 0, "group": "root", "md5sum": "00c2da87cb5b5b784f2915a02b8c10c3", "mode": "0644", "owner": "root", "size": 1132, "src": "/home/nginx/.ansible/tmp/ansible-tmp-1650609345.0508504-186875093539325/source", "state": "file", "uid": 0}

TASK [Remove symlink] *****************************************************************************************************************
changed: [nginx-tmp] => {"changed": true, "path": "/etc/nginx/sites-enabled/default", "state": "absent"}

TASK [Remove file nginx default config file] ******************************************************************************************
changed: [nginx-tmp] => {"changed": true, "path": "/etc/nginx/sites-available/default", "state": "absent"}

TASK [Create a symbolic link] *********************************************************************************************************
changed: [nginx-tmp] => {"changed": true, "dest": "/etc/nginx/sites-enabled/nexus", "gid": 0, "group": "root", "mode": "0777", "owner": "root", "size": 32, "src": "/etc/nginx/sites-available/nexus", "state": "link", "uid": 0}

RUNNING HANDLER [Restart nginx service] ***********************************************************************************************
changed: [nginx-tmp] => {"changed": true, "name": "nginx", "state": "started", "status": {"ActiveEnterTimestamp": "Fri 2022-04-22 06:28:49 UTC", "ActiveEnterTimestampMonotonic": "16684685069", "ActiveExitTimestampMonotonic": "0", "ActiveState": "active", "After": "network.target system.slice systemd-journald.socket sysinit.target basic.target", "AllowIsolate": "no", "AllowedCPUs": "", "AllowedMemoryNodes": "", "AmbientCapabilities": "", "AssertResult": "yes", "AssertTimestamp": "Fri 2022-04-22 06:28:49 UTC", "AssertTimestampMonotonic": "16684659106", "Before": "shutdown.target multi-user.target", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "CPUAccounting": "no", "CPUAffinity": "", "CPUAffinityFromNUMA": "no", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "[not set]", "CPUUsageNSec": "[not set]", "CPUWeight": "[not set]", "CacheDirectoryMode": "0755", "CanIsolate": "no", "CanReload": "yes", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read 0x26 0x27 0x28", "CleanResult": "success", "CollectMode": "inactive", "ConditionResult": "yes", "ConditionTimestamp": "Fri 2022-04-22 06:28:49 UTC", "ConditionTimestampMonotonic": "16684659105", "ConfigurationDirectoryMode": "0755", "Conflicts": "shutdown.target", "ControlGroup": "/system.slice/nginx.service", "ControlPID": "0", "DefaultDependencies": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "Delegate": "no", "Description": "A high performance web server and a reverse proxy server", "DevicePolicy": "auto", "Documentation": "man:nginx(8)", "DynamicUser": "no", "EffectiveCPUs": "", "EffectiveMemoryNodes": "", "ExecMainCode": "0", "ExecMainExitTimestampMonotonic": "0", "ExecMainPID": "60575", "ExecMainStartTimestamp": "Fri 2022-04-22 06:28:49 UTC", "ExecMainStartTimestampMonotonic": "16684685032", "ExecMainStatus": "0", "ExecReload": "{ path=/usr/sbin/nginx ; argv[]=/usr/sbin/nginx -g daemon on; master_process on; -s reload ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecReloadEx": "{ path=/usr/sbin/nginx ; argv[]=/usr/sbin/nginx -g daemon on; master_process on; -s reload ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStart": "{ path=/usr/sbin/nginx ; argv[]=/usr/sbin/nginx -g daemon on; master_process on; ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStartEx": "{ path=/usr/sbin/nginx ; argv[]=/usr/sbin/nginx -g daemon on; master_process on; ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStartPre": "{ path=/usr/sbin/nginx ; argv[]=/usr/sbin/nginx -t -q -g daemon on; master_process on; ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStartPreEx": "{ path=/usr/sbin/nginx ; argv[]=/usr/sbin/nginx -t -q -g daemon on; master_process on; ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStop": "{ path=/sbin/start-stop-daemon ; argv[]=/sbin/start-stop-daemon --quiet --stop --retry QUIT/5 --pidfile /run/nginx.pid ; ignore_errors=yes ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStopEx": "{ path=/sbin/start-stop-daemon ; argv[]=/sbin/start-stop-daemon --quiet --stop --retry QUIT/5 --pidfile /run/nginx.pid ; flags=ignore-failure ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FinalKillSignal": "9", "FragmentPath": "/lib/systemd/system/nginx.service", "GID": "[not set]", "GuessMainPID": "yes", "IOAccounting": "no", "IOReadBytes": "18446744073709551615", "IOReadOperations": "18446744073709551615", "IOSchedulingClass": "0", "IOSchedulingPriority": "0", "IOWeight": "[not set]", "IOWriteBytes": "18446744073709551615", "IOWriteOperations": "18446744073709551615", "IPAccounting": "no", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "Id": "nginx.service", "IgnoreOnIsolate": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestampMonotonic": "0", "InactiveExitTimestamp": "Fri 2022-04-22 06:28:49 UTC", "InactiveExitTimestampMonotonic": "16684661760", "InvocationID": "3c27af3db4d54703ad5d4d0ed1fc1760", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "JobTimeoutUSec": "infinity", "KeyringMode": "private", "KillMode": "mixed", "KillSignal": "15", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitCORE": "infinity", "LimitCORESoft": "0", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitMEMLOCK": "65536", "LimitMEMLOCKSoft": "65536", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitNOFILE": "524288", "LimitNOFILESoft": "1024", "LimitNPROC": "15656", "LimitNPROCSoft": "15656", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "LimitSIGPENDING": "15656", "LimitSIGPENDINGSoft": "15656", "LimitSTACK": "infinity", "LimitSTACKSoft": "8388608", "LoadState": "loaded", "LockPersonality": "no", "LogLevelMax": "-1", "LogRateLimitBurst": "0", "LogRateLimitIntervalUSec": "0", "LogsDirectoryMode": "0755", "MainPID": "60575", "MemoryAccounting": "yes", "MemoryCurrent": "2265088", "MemoryDenyWriteExecute": "no", "MemoryHigh": "infinity", "MemoryLimit": "infinity", "MemoryLow": "0", "MemoryMax": "infinity", "MemoryMin": "0", "MemorySwapMax": "infinity", "MountAPIVFS": "no", "MountFlags": "", "NFileDescriptorStore": "0", "NRestarts": "0", "NUMAMask": "", "NUMAPolicy": "n/a", "Names": "nginx.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "none", "OOMPolicy": "stop", "OOMScoreAdjust": "0", "OnFailureJobMode": "replace", "PIDFile": "/run/nginx.pid", "Perpetual": "no", "PrivateDevices": "no", "PrivateMounts": "no", "PrivateNetwork": "no", "PrivateTmp": "no", "PrivateUsers": "no", "ProtectControlGroups": "no", "ProtectHome": "no", "ProtectHostname": "no", "ProtectKernelLogs": "no", "ProtectKernelModules": "no", "ProtectKernelTunables": "no", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "ReloadResult": "success", "RemainAfterExit": "no", "RemoveIPC": "no", "Requires": "system.slice sysinit.target", "Restart": "no", "RestartKillSignal": "15", "RestartUSec": "100ms", "RestrictNamespaces": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "Result": "success", "RootDirectoryStartOnly": "no", "RuntimeDirectoryMode": "0755", "RuntimeDirectoryPreserve": "no", "RuntimeMaxUSec": "infinity", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "Slice": "system.slice", "StandardError": "inherit", "StandardInput": "null", "StandardInputData": "", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "5", "StartLimitIntervalUSec": "10s", "StartupBlockIOWeight": "[not set]", "StartupCPUShares": "[not set]", "StartupCPUWeight": "[not set]", "StartupIOWeight": "[not set]", "StateChangeTimestamp": "Fri 2022-04-22 06:28:49 UTC", "StateChangeTimestampMonotonic": "16684685069", "StateDirectoryMode": "0755", "StatusErrno": "0", "StopWhenUnneeded": "no", "SubState": "running", "SuccessAction": "none", "SyslogFacility": "3", "SyslogLevel": "6", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "0", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "yes", "TasksCurrent": "3", "TasksMax": "4696", "TimeoutAbortUSec": "5s", "TimeoutCleanUSec": "infinity", "TimeoutStartUSec": "1min 30s", "TimeoutStopUSec": "5s", "TimerSlackNSec": "50000", "Transient": "no", "Type": "forking", "UID": "[not set]", "UMask": "0022", "UnitFilePreset": "enabled", "UnitFileState": "enabled", "UtmpMode": "init", "WantedBy": "multi-user.target", "WatchdogSignal": "6", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "0"}}

PLAY RECAP ****************************************************************************************************************************
nginx-tmp                  : ok=15   changed=8    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0


User@Lenovo-PC ~/Ansible_playbooks
$

